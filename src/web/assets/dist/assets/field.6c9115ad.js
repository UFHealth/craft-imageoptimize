function f(t,a=!1,e=1){const n=a?1e3:1024;if(Math.abs(t)<n)return t+" B";const s=a?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let i=-1;const o=10**e;do t/=n,++i;while(Math.round(Math.abs(t)*o)/o>=n&&i<s.length-1);return t.toFixed(e)+" "+s[i]}function c(t){const a=t.src||t.href;if(a&&a.length>0){const e=performance.getEntriesByName(a)[0];if(e!==void 0){const n=t.parentNode.parentNode.parentNode.nextElementSibling.querySelector(".io-file-size");n&&(n.innerHTML=f(e.decodedBodySize,!0))}}}(function(t,a,e,n){var s="ImageOptimizeOptimizedImages",i={};function o(d,l){this.element=d,this.options=t.extend({},i,l),this._defaults=i,this._name=s,this.init()}o.prototype={init:function(d){t(function(){const l=e.querySelectorAll("img.io-preview-image");for(const r of l)r.complete?c(r):r.addEventListener("load",u=>{c(u.target)})})}},t.fn[s]=function(d){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new o(this,d))})}})(jQuery,window,document);Craft.OptimizedImagesInput=Garnish.Base.extend({id:null,inputNamePrefix:null,inputIdPrefix:null,$container:null,$blockContainer:null,$addBlockBtnContainer:null,$addBlockBtnGroup:null,$addBlockBtnGroupBtns:null,blockSort:null,blockSelect:null,init:function(t,a,e){this.id=t,this.inputNamePrefix=a,this.inputIdPrefix=Craft.formatInputId(this.inputNamePrefix),this.$container=$("#"+this.id),this.$blockContainer=this.$container.children(".variant-blocks"),this.$addBlockBtnContainer=this.$container.children(".buttons"),this.$addBlockBtnGroup=this.$addBlockBtnContainer.children(".btngroup"),this.$addBlockBtnGroupBtns=this.$addBlockBtnGroup.children(".btn");var n=this;this.$blockContainer.find("> > .actions > .settings").each(function(i,o){var d=$(o),l;d.data("menubtn")?l=d.data("menubtn"):l=new Garnish.MenuBtn(o),l.menu.settings.onOptionSelect=$.proxy(function(r){this.onMenuOptionSelect(r,l)},n)});var s=this.$blockContainer.children();this.blockSort=new Garnish.DragSort(s,{handle:"> .actions > .move",axis:"y",collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,helperOpacity:.9,onSortChange:$.proxy(function(){this.resetVariantBlockOrder()},this)}),this.addListener(this.$addBlockBtnGroupBtns,"click",function(i){$(i.target).data("type"),this.addVariantBlock(null)}),this.addAspectRatioHandlers(),this.reIndexVariants()},onMenuOptionSelect:function(t,a){var e=$(t),n=a.$btn.closest(".matrixblock");switch(e.data("action")){case"add":{this.addVariantBlock(n);break}case"delete":{e.hasClass("disabled")||this.deleteVariantBlock(n);break}}},getHiddenBlockCss:function(t){return{opacity:0,marginBottom:-t.outerHeight()}},reIndexVariants:function(){this.$blockContainer=this.$container.children(".variant-blocks");var t=this.$blockContainer.children();t.each(function(e,n){var s=e,i=$(n),o=i.find("div .field, label, input, select");$(o).each(function(d,l){var r=$(l).attr("id");r&&(r=r.replace(/\-([0-9]+)\-/g,"-"+s+"-"),$(l).attr("id",r)),r=$(l).attr("for"),r&&(r=r.replace(/\-([0-9]+)\-/g,"-"+s+"-"),$(l).attr("for",r)),r=$(l).attr("name"),r&&(r=r.replace(/\[([0-9]+)\]/g,"["+s+"]"),$(l).attr("name",r))})});var a=!1;t.length==1&&(a=!0),t.find("> .actions > .settings").each(function(e,n){var s=$(n),i;if(s.data("menubtn")){i=s.data("menubtn");let o=$(i.menu.$menuList[1]);typeof o!==void 0&&(a?o.find("> li > a").addClass("disabled").disable():o.find("> li > a").removeClass("disabled").enable())}})},addAspectRatioHandlers:function(){this.addListener($(".lightswitch"),"click",function(t){var a=$(t.target),e=a.closest(".matrixblock");e.find(".io-aspect-ratio-wrapper").slideToggle()}),this.addListener($(".io-select-ar-box"),"click",function(t){var a=$(t.target),e=$(t.target).data("x"),n=$(t.target).data("y"),s=$(t.target).data("custom"),i,o;o=a.closest(".matrixblock"),o.find(".io-select-ar-box").each(function(d,l){$(l).removeClass("io-selected-ar-box")}),a.addClass("io-selected-ar-box"),s?o.find(".io-custom-ar-wrapper").slideDown():(o.find(".io-custom-ar-wrapper").slideUp(),i=o.find("input")[2],$(i).val(e),i=o.find("input")[3],$(i).val(n))})},addVariantBlock:function(t){var a=this;let e=$(this.$blockContainer.children()[0]).clone();e.find(".io-select-ar-box").each(function(s,i){s===0?$(i).addClass("io-selected-ar-box"):$(i).removeClass("io-selected-ar-box")}),e.find(".io-custom-ar-wrapper").hide();let n=e.find("input")[0];$(n).val(1200),n=e.find("input")[1],$(n).val(1),n=e.find("input")[2],$(n).val(16),n=e.find("input")[3],$(n).val(9),n=e.find("select")[0],$(n).val(82),n=e.find("select")[1],$(n).val("jpg"),e.css(this.getHiddenBlockCss(e)).velocity({opacity:1,"margin-bottom":10},"fast",$.proxy(function(){t?e.insertBefore(t):e.appendTo(this.$blockContainer),this.blockSort.addItems(e),this.addAspectRatioHandlers(),e.find(".settings").each(function(s,i){var o=$(i),d,l;l=a.$container.find(".io-menu-clone > .menu").clone(),$(l).insertAfter(o),d=new Garnish.MenuBtn(i),d.menu.settings.onOptionSelect=$.proxy(function(r){a.onMenuOptionSelect(r,d)},this)}),this.reIndexVariants()},this))},deleteVariantBlock:function(t){var a=this;t.velocity(this.getHiddenBlockCss(t),"fast",$.proxy(function(){t.remove(),a.reIndexVariants()},this))},resetVariantBlockOrder:function(){this.reIndexVariants()}});
//# sourceMappingURL=field.6c9115ad.js.map
