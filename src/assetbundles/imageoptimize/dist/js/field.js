/*!
 * @project        imageoptimize
 * @name           field.js
 * @author         Andrew Welch
 * @build          Tue Mar 02 2021 04:10:00 GMT+0000 (Coordinated Universal Time)
 * @copyright      Copyright (c) 2021 Â©2020 nystudio107.com
 *
 */
(self.webpackChunkimageoptimize=self.webpackChunkimageoptimize||[]).push([[708],{5679:function(t,e,i){"use strict";i(9826),i(6977),i(4916),i(5306);var a=Vue,r=i.n(a),n=r().extend({props:{label:{type:String,default:"label"},strokeColor:{type:String,default:"#AAA"},fillColor:{type:String,default:"#FFF"}},data:()=>({id:null,markerWidth:4,markerHeight:4,lineY:12}),mounted(){this.id=this._uid},methods:{}}),o=i(1900),s=(0,o.Z)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{attrs:{width:"100%",height:"20px",xmlns:"http://www.w3.org/2000/svg"}},[i("marker",{attrs:{id:t.id+"startArrow",markerWidth:t.markerWidth,markerHeight:t.markerHeight,refX:t.markerWidth,refY:t.markerHeight/2,orient:"auto"}},[i("polygon",{attrs:{points:t.markerWidth+" 0, "+t.markerWidth+" "+t.markerHeight+", 0 "+t.markerHeight/2,fill:t.strokeColor}})]),t._v(" "),i("marker",{attrs:{id:t.id+"endArrow",markerWidth:t.markerWidth,markerHeight:t.markerHeight,refX:t.markerWidth,refY:t.markerHeight/2,orient:"auto",markerUnits:"strokeWidth"}},[i("polygon",{attrs:{points:"0 0, "+t.markerWidth+" "+t.markerHeight/2+", 0 "+t.markerHeight,fill:t.strokeColor}})]),t._v(" "),i("line",{attrs:{x1:2*t.markerWidth,y1:t.lineY,x2:"100%",y2:t.lineY,stroke:t.strokeColor,"stroke-width":"2","marker-end":"url(#"+t.id+"endArrow)","marker-start":"url(#"+t.id+"startArrow)"}}),t._v(" "),i("text",{attrs:{x:"50%",y:t.lineY+4,"text-anchor":"middle",stroke:t.fillColor,"stroke-width":"5"}},[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),i("text",{attrs:{x:"50%",y:t.lineY+4,"text-anchor":"middle",fill:t.strokeColor}},[t._v("\n    "+t._s(t.label)+"\n  ")])])}),[],!1,null,null,null).exports,l=r().extend({props:{x:{type:Number,default:1},y:{type:Number,default:1},width:{type:Number,default:1},height:{type:Number,default:1},strokeColor:{type:String,default:"#AAA"},strokeWidth:{type:Number,default:2},hatchColor:{type:String,default:"#AAA"},hatchWidth:{type:Number,default:1}},data:()=>({id:null}),mounted(){this.id=this._uid},methods:{}}),d=(0,o.Z)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",[i("pattern",{attrs:{id:"diagonalHatch"+t.id,patternUnits:"userSpaceOnUse",width:"4",height:"4"}},[i("path",{attrs:{d:"M-1,1 l2,-2\n         M0,4 l4,-4\n         M3,5 l2,-2",stroke:t.hatchColor,"stroke-width":t.hatchWidth}})]),t._v(" "),i("rect",{attrs:{x:t.x,y:t.y,width:t.width,height:t.height,stroke:t.strokeColor,"stroke-width":t.strokeWidth,fill:"url(#diagonalHatch"+t.id+")"}})])}),[],!1,null,null,null).exports,u=r().extend({components:{"arrow-line":s},props:{x:{type:Number,default:1},y:{type:Number,default:1},width:{type:Number,default:1},height:{type:Number,default:1},strokeColor:{type:String,default:"rgb(163, 193, 226)"},strokeWidth:{type:Number,default:2},fillColor:{type:String,default:"rgb(221, 231, 242)"},hatchColor:{type:String,default:"#AAA"},sawtooth:{type:Boolean,default:!0},sawToothSize:{type:Number,default:10},showArrow:{type:Boolean,default:!0},showImage:{type:Boolean,default:!0}},data:()=>({id:null}),methods:{pointsForImagePoly(){const t=this.x+1;let e=t+this.width;const i=this.y;let a=this.y+this.height;let r=`${t},${a-this.width%(2*this.sawToothSize)} ${t},${i} ${e},${i} ${e},${a}`;if(this.sawtooth){let i=this.sawToothSize,n=this.sawToothSize;for(;e>t;)r+=` ${e},${a}`,e-=n,a-=i,i*=-1;r+=` ${t},${a+e-t}`,r+=` ${t},${this.y+this.height-2*this.sawToothSize}`}else r+=` ${t},${a}`,r+=` ${t},${a-2*this.sawToothSize}`;return r},placeholderX(){return this.x+(this.width/2-this.placeholderWidth()/2)},placeholderWidth(){let t=this.width/5;return Math.max(t,50)}}}),c=(0,o.Z)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",[i("polyline",{staticStyle:{transition:"point 2s ease"},attrs:{points:t.pointsForImagePoly(),stroke:t.strokeColor,"stroke-width":t.strokeWidth,fill:t.fillColor}}),t._v(" "),i("svg",{attrs:{width:t.width-10,x:t.x+5,y:"60"}},[t.showArrow?i("arrow-line",{attrs:{label:t.width+"w","stroke-color":"rgb(163, 193, 226)","fill-color":"rgb(221, 231, 242)"}}):t._e()],1),t._v(" "),t.showImage?i("svg",{attrs:{x:t.placeholderX(),y:"10",width:t.placeholderWidth(),viewBox:"0 0 185 170",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{fill:t.strokeColor,d:"M15 130.896V16.994c0-1.097.898-1.994 2.007-1.994h150.986A2 2 0 0 1 170 16.994v69.147L133.015 51 87.26 120.377l-35.863-17.758L15 130.896zM2 0C.895 0 0 .887 0 2v166c0 1.105.887 2 2 2h181c1.105 0 2-.887 2-2V2c0-1.105-.887-2-2-2H2zm49 72c11.046 0 20-9.178 20-20.5S62.046 31 51 31s-20 9.178-20 20.5S39.954 72 51 72z","fill-rule":"evenodd"}})]):t._e()])}),[],!1,null,null,null).exports,h=r().extend({props:{label:{type:String,default:"Label"},instructions:{type:String,default:"Instructions"},classes:{type:Array,default:()=>[]}},data:()=>({id:null}),mounted(){this.id=this._uid},methods:{}}),p=(0,o.Z)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"field",class:t.classes,attrs:{id:t.id+"-field","aria-describedby":t.id+"-field-instructions"}},[i("div",{staticClass:"heading"},[i("label",{attrs:{id:t.id+"-field-label",for:t.id}},[t._v("\n      "+t._s(t.label)+"\n    ")])]),t._v(" "),t.instructions?i("div",{staticClass:"instructions",attrs:{id:t.id+"-field-instructions"}},[i("p",[t._v("\n      "+t._s(t.instructions)+"\n    ")])]):t._e(),t._v(" "),i("div",{staticClass:"input ltr"},[t._t("default")],2)])}),[],!1,null,null,null).exports,f=r().extend({components:{"craft-field-wrapper":p},props:{value:{type:Number,default:0},field:{type:String,default:"field"},name:{type:String,default:"types[woof]"},size:{type:Number,default:5},label:{type:String,default:"Label"},instructions:{type:String,default:"Instructions"},min:{type:Number,default:1},max:{type:Number,default:1e4},errors:{type:Array,default:()=>[]}},data(){return{id:null,inputErrors:this.errors}},computed:{inputClasses(){let t=[];return this.inputErrors.length&&t.push("error"),t}},mounted(){this.id=this._uid},methods:{validateInput(t){let e=t.target.value;this.inputErrors=[],e<this.min&&this.inputErrors.push("Too small"),e>this.max&&this.inputErrors.push("Too big"),this.$emit("update:"+this.field,parseInt(e))}}}),m=(0,o.Z)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("craft-field-wrapper",{attrs:{label:t.label,instructions:t.instructions,classes:["width-25"]}},[i("input",{staticClass:"text",class:t.inputClasses,attrs:{id:t.id,name:t.name,size:t.size,min:t.min,max:t.max,type:"number",autocomplete:"off",step:"1"},domProps:{value:t.value},on:{input:function(e){return t.validateInput(e)}}}),t._v(" "),t.inputErrors.length?i("ul",{staticClass:"errors"},t._l(t.inputErrors,(function(e,a){return i("li",{key:"error"+a},[t._v("\n      "+t._s(e)+"\n    ")])})),0):t._e()])}),[],!1,null,null,null).exports;var g=r().extend({components:{"image-preview-box":c,"craft-number-field":m,"arrow-line":s,"hatch-box":d},props:{id:{type:String,default:""},numUp:{type:Number,default:3},ratioX:{type:Number,default:16},ratioY:{type:Number,default:9},useAspectRatio:{type:Boolean,default:!0},widthMultiplier:{type:Number,default:1},breakpointValue:{type:Number,default:1e3},breakpointUnits:{type:String,default:""},rowPaddingValue:{type:Number,default:100},rowPaddingUnits:{type:String,default:"px"},cellPaddingValue:{type:Number,default:20},cellPaddingUnits:{type:String,default:"px"}},data:()=>({}),computed:{breakpointWidth(){return this.breakpointValue*this.widthMultiplier/1e3*100+"%"},rowWidth(){return this.breakpointValue-2*this.rowPaddingValue},cellWidth(){return this.rowWidth/this.numUp},imageWidth(){return Math.round(this.cellWidth-2*this.cellPaddingValue)},title(){let t=Math.round(100/this.numUp);return`(min-width: ${this.breakpointValue+this.breakpointUnits}) calc((${t+"vw"} - ${Math.round(2*this.rowPaddingValue/this.numUp)+this.rowPaddingUnits}) - ${2*this.cellPaddingValue+this.cellPaddingUnits})`}},methods:{cellX(t){return this.rowPaddingValue+(t-1)*(this.rowWidth/this.numUp)},imageX(t){return this.cellPaddingValue+this.cellX(t)},xForRect(t){return(t-1)*(this.breakpointValue/this.numUp)},calcHeight(t){return t*(this.ratioY/this.ratioX)}}}),b=(0,o.Z)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"matrixblock"},[i("div",{staticClass:"titlebar"},[i("div",{staticClass:"blocktype"},[i("code",[i("span",{staticClass:"text-gray-500"},[t._v('srcset="')]),t._v("example.jpg "+t._s(t.imageWidth)+"w"),i("span",{staticClass:"text-gray-500"},[t._v('"')])]),t._v(" "),i("code",[i("span",{staticClass:"text-gray-500"},[t._v('sizes="')]),t._v(t._s(t.title)),i("span",{staticClass:"text-gray-500"},[t._v('"')])])]),t._v(" "),i("div",{staticClass:"preview"})]),t._v(" "),i("div",{staticClass:"actions"}),t._v(" "),i("div",{staticClass:"fields"},[i("div",{staticClass:"flex-fields"},[i("craft-number-field",t._g({attrs:{value:t.breakpointValue,size:10,min:300,max:2560,field:"breakpointValue",name:"types[breakpointValue]",label:"CSS breakpoint",instructions:""}},t.$listeners)),t._v(" "),i("craft-number-field",t._g({attrs:{value:t.numUp,size:5,min:1,max:8,field:"numUp",name:"types[numUp]",label:"Images per row",instructions:""}},t.$listeners)),t._v(" "),i("craft-number-field",t._g({attrs:{value:t.rowPaddingValue,size:10,min:0,max:1e3,field:"rowPaddingValue",name:"types[rowPaddingValue]",label:"Row Padding",instructions:""}},t.$listeners)),t._v(" "),i("craft-number-field",t._g({attrs:{value:t.cellPaddingValue,size:10,min:0,max:1e3,field:"cellPaddingValue",name:"types[cellPaddingValue]",label:"Cell Padding",instructions:""}},t.$listeners))],1),t._v(" "),i("div",{staticClass:"field"},[i("svg",{attrs:{width:t.breakpointWidth,viewBox:"0 0 "+t.breakpointValue+" "+(t.calcHeight(t.imageWidth)+100),preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("arrow-line",{attrs:{label:t.breakpointValue+t.breakpointUnits}}),t._v(" "),i("rect",{attrs:{x:"1",y:"20",width:t.breakpointValue-2,height:t.calcHeight(t.imageWidth)+80,fill:"#DDD",stroke:"#AAA","stroke-width":"2"}}),t._v(" "),i("hatch-box",{attrs:{x:"0",y:"20",width:t.rowPaddingValue,height:t.calcHeight(t.imageWidth)+80,"stroke-color":"#AAA","stroke-width":2,"hatch-color":"#AAA"}}),t._v(" "),i("hatch-box",{attrs:{x:t.breakpointValue-t.rowPaddingValue,y:20,width:t.rowPaddingValue,height:t.calcHeight(t.imageWidth)+80,"stroke-color":"#AAA","stroke-width":2,"hatch-color":"#AAA"}}),t._v(" "),t._l(t.numUp,(function(e,a){return i("svg",{key:"svg"+a},[i("hatch-box",{attrs:{x:t.cellX(e),y:40,width:t.cellWidth,height:t.calcHeight(t.imageWidth)+40,"stroke-color":"rgb(163, 193, 226)","stroke-width":2,"hatch-color":"rgb(163, 193, 226)"}}),t._v(" "),i("image-preview-box",{attrs:{x:t.imageX(e),y:60,width:t.imageWidth,height:t.calcHeight(t.imageWidth),sawtooth:!t.useAspectRatio}})],1)}))],2)])])])}),[],!1,null,null,null).exports,k=r().extend({components:{"image-preview-box":c},props:{selected:{type:Boolean,default:!1},ratioX:{type:Number,default:1},ratioY:{type:Number,default:1},useAspectRatio:{type:Boolean,default:!0},containerSize:{type:Number,default:100}},data:()=>({id:null}),computed:{displayText(){return this.useAspectRatio?`${this.ratioX}:${this.ratioY}`:"none"},strokeColor(){return this.selected?"rgb(163, 193, 226)":"#AAA"},fillColor(){return this.selected?"rgb(221, 231, 242)":"#DDD"},aspectRatio(){return this.ratioX/this.ratioY},width(){if(!this.useAspectRatio)return this.containerSize-2;let t=this.containerSize/2;return this.aspectRatio>1&&(t=this.containerSize/2*this.aspectRatio),t},height(){if(!this.useAspectRatio)return this.containerSize/1.5;let t=this.containerSize/2;return this.aspectRatio<1&&(t=this.containerSize/2/this.aspectRatio),t}},mounted(){this.id=this._uid},methods:{handleClick(){this.$emit("update:ratio-x",this.ratioX),this.$emit("update:ratio-y",this.ratioY),this.$emit("update:use-aspect-ratio",this.useAspectRatio)}}}),v=(0,o.Z)(k,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inline-block p-2 cursor-pointer",on:{click:t.handleClick}},[i("svg",{attrs:{width:t.containerSize,height:t.containerSize,preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg"}},[i("rect",{attrs:{x:"0",y:"0",width:t.containerSize,height:t.containerSize,stroke:t.strokeColor,"stroke-width":"4",fill:t.fillColor,"stroke-opacity":"0.5","fill-opacity":"0.0","stroke-dasharray":"5, 5"}}),t._v(" "),i("image-preview-box",{attrs:{x:0,y:1,width:t.width,height:t.height,"stroke-width":2,sawtooth:!t.useAspectRatio,"saw-tooth-size":5,"show-arrow":!1,"show-image":!1,"stroke-color":t.strokeColor,"fill-color":t.fillColor}}),t._v(" "),i("text",{attrs:{x:t.width/2,y:t.height/2,fill:t.strokeColor,"text-anchor":"middle","alignment-baseline":"central","font-size":t.containerSize/5}},[t._v("\n      "+t._s(t.displayText)+"\n    ")])],1)])}),[],!1,null,null,null).exports,y=r().extend({components:{"aspect-ratio-box":v},props:{ratioX:{type:Number,default:1},ratioY:{type:Number,default:1},aspectRatios:{type:Array,default:[{ratioX:16.01,ratioY:9,useAspectRatio:!1},{ratioX:16,ratioY:9,useAspectRatio:!0},{ratioX:8,ratioY:5,useAspectRatio:!0},{ratioX:4,ratioY:3,useAspectRatio:!0},{ratioX:5,ratioY:4,useAspectRatio:!0},{ratioX:1,ratioY:1,useAspectRatio:!0},{ratioX:4,ratioY:5,useAspectRatio:!0},{ratioX:3,ratioY:4,useAspectRatio:!0},{ratioX:5,ratioY:8,useAspectRatio:!0},{ratioX:9,ratioY:16,useAspectRatio:!0}]}},data:()=>({}),methods:{}}),w=(0,o.Z)(y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._l(t.aspectRatios,(function(e){return i("aspect-ratio-box",t._g({key:e.ratioX+":"+e.ratioY,attrs:{selected:t.ratioX===e.ratioX&&t.ratioY===e.ratioY,"ratio-x":e.ratioX,"ratio-y":e.ratioY,"use-aspect-ratio":e.useAspectRatio,"container-size":80}},t.$listeners))})),1)}),[],!1,null,null,null).exports;var x=r().extend({components:{"aspect-ratio-chooser":w,"sizes-visualization":b,"craft-field-wrapper":p},props:{ratioX:{default:16,type:Number},ratioY:{default:9,type:Number},useAspectRatio:{type:Boolean,default:!0},id:{type:String,default:""},sizesDataList:{type:Array,default:[{numUp:4,breakpointValue:1280,breakpointUnits:"px",rowPaddingValue:100,rowPaddingUnits:"px",cellPaddingValue:20,cellPaddingUnits:"px"},{numUp:2,breakpointValue:1024,breakpointUnits:"px",rowPaddingValue:100,rowPaddingUnits:"px",cellPaddingValue:20,cellPaddingUnits:"px"},{numUp:1,breakpointValue:768,breakpointUnits:"px",rowPaddingValue:100,rowPaddingUnits:"px",cellPaddingValue:20,cellPaddingUnits:"px"}]}},data:()=>({title:""}),computed:{widthMultiplier(){let t=0;return t=Math.max(...this.sizesDataList.map((t=>parseInt(t.breakpointValue)))),t>1e3?1e3/t:1}},methods:{}}),_=(0,o.Z)(x,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("craft-field-wrapper",{attrs:{label:"Aspect Ratio",instructions:"Choose the aspect ratio that the images in this srcset should be displayed in"}},[i("aspect-ratio-chooser",{attrs:{"ratio-x":t.ratioX,"ratio-y":t.ratioY,"use-aspect-ratio":t.useAspectRatio},on:{"update:ratioX":function(e){t.ratioX=e},"update:ratio-x":function(e){t.ratioX=e},"update:ratioY":function(e){t.ratioY=e},"update:ratio-y":function(e){t.ratioY=e},"update:useAspectRatio":function(e){t.useAspectRatio=e},"update:use-aspect-ratio":function(e){t.useAspectRatio=e}}})],1),t._v(" "),i("craft-field-wrapper",{attrs:{label:"Image srcset",instructions:"Describe how the images will be laid out on the page for each CSS breakpoint"}},[i("div",{staticClass:"matrix",staticStyle:{position:"relative"}},[i("div",{staticClass:"variant-blocks"},t._l(t.sizesDataList,(function(e,a){return i("div",{key:"sizes"+a},[i("sizes-visualization",t._b({attrs:{id:t.id,"width-multiplier":t.widthMultiplier,"ratio-x":t.ratioX,"ratio-y":t.ratioY,"use-aspect-ratio":t.useAspectRatio}},"sizes-visualization",e,!1,!0))],1)})),0)])])],1)}),[],!1,null,null,null).exports;function C(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return A(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,n=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw n}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function S(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e?1e3:1024;if(Math.abs(t)<a)return t+" B";var r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=-1,o=Math.pow(10,i);do{t/=a,++n}while(Math.round(Math.abs(t)*o)/o>=a&&n<r.length-1);return t.toFixed(i)+" "+r[n]}!function(t,e,i,a){var r="ImageOptimizeOptimizedImages",n={};function o(e,i){this.element=e,this.options=t.extend({},n,i),this._defaults=n,this._name=r,this.init()}o.prototype={init:function(e){t((function(){var t,e=C(i.querySelectorAll("img.io-preview-image"));try{for(e.s();!(t=e.n()).done;){var a=t.value,r=a.src||a.href;if(r&&r.length>0){var n=performance.getEntriesByName(r)[0];if(undefined!==n){var o=a.parentNode.parentNode.parentNode.nextElementSibling.querySelector(".io-file-size");o&&(o.innerHTML=S(n.decodedBodySize,!0))}}}}catch(t){e.e(t)}finally{e.f()}}))}},t.fn[r]=function(e){return this.each((function(){t.data(this,"plugin_"+r)||t.data(this,"plugin_"+r,new o(this,e))}))}}(jQuery,window,document),Craft.OptimizedImagesInput=Garnish.Base.extend({id:null,inputNamePrefix:null,inputIdPrefix:null,$container:null,$blockContainer:null,$addBlockBtnContainer:null,$addBlockBtnGroup:null,$addBlockBtnGroupBtns:null,blockSort:null,blockSelect:null,init:function(t,e,i){!function(t){new Vue({el:"#"+t,components:{"sizes-container":_},data:{},methods:{},mounted:function(){}})}(i),this.id=t,this.inputNamePrefix=e,this.inputIdPrefix=Craft.formatInputId(this.inputNamePrefix),this.$container=$("#"+this.id),this.$blockContainer=this.$container.children(".variant-blocks"),this.$addBlockBtnContainer=this.$container.children(".buttons"),this.$addBlockBtnGroup=this.$addBlockBtnContainer.children(".btngroup"),this.$addBlockBtnGroupBtns=this.$addBlockBtnGroup.children(".btn");var a=this;this.$blockContainer.find("> > .actions > .settings").each((function(t,e){var i,r=$(e);(i=r.data("menubtn")?r.data("menubtn"):new Garnish.MenuBtn(e)).menu.settings.onOptionSelect=$.proxy((function(t){this.onMenuOptionSelect(t,i)}),a)}));var r=this.$blockContainer.children();this.blockSort=new Garnish.DragSort(r,{handle:"> .actions > .move",axis:"y",collapseDraggees:!0,magnetStrength:4,helperLagBase:1.5,helperOpacity:.9,onSortChange:$.proxy((function(){this.resetVariantBlockOrder()}),this)}),this.addListener(this.$addBlockBtnGroupBtns,"click",(function(t){$(t.target).data("type");this.addVariantBlock(null)})),this.addAspectRatioHandlers(),this.reIndexVariants()},onMenuOptionSelect:function(t,e){var i=$(t),a=e.$btn.closest(".matrixblock");switch(i.data("action")){case"add":this.addVariantBlock(a);break;case"delete":i.hasClass("disabled")||this.deleteVariantBlock(a)}},getHiddenBlockCss:function(t){return{opacity:0,marginBottom:-t.outerHeight()}},reIndexVariants:function(){this.$blockContainer=this.$container.children(".variant-blocks");var t=this.$blockContainer.children();t.each((function(t,e){var i=t,a=$(e).find("div .field, label, input, select");$(a).each((function(t,e){var a=$(e).attr("id");a&&(a=a.replace(/\-([0-9]+)\-/g,"-"+i+"-"),$(e).attr("id",a)),(a=$(e).attr("for"))&&(a=a.replace(/\-([0-9]+)\-/g,"-"+i+"-"),$(e).attr("for",a)),(a=$(e).attr("name"))&&(a=a.replace(/\[([0-9]+)\]/g,"["+i+"]"),$(e).attr("name",a))}))}));var e=!1;1==t.length&&(e=!0),t.find("> .actions > .settings").each((function(t,i){var a,r=$(i);r.data("menubtn")&&(a=r.data("menubtn"),$menuItem=$(a.menu.$menuList[1]),e?$menuItem.find("> li > a").addClass("disabled").disable():$menuItem.find("> li > a").removeClass("disabled").enable())}))},addAspectRatioHandlers:function(){this.addListener($(".lightswitch"),"click",(function(t){$(t.target).closest(".matrixblock").find(".io-aspect-ratio-wrapper").slideToggle()})),this.addListener($(".io-select-ar-box"),"click",(function(t){var e,i,a=$(t.target),r=$(t.target).data("x"),n=$(t.target).data("y"),o=$(t.target).data("custom");(i=a.closest(".matrixblock")).find(".io-select-ar-box").each((function(t,e){$(e).removeClass("io-selected-ar-box")})),a.addClass("io-selected-ar-box"),o?i.find(".io-custom-ar-wrapper").slideDown():(i.find(".io-custom-ar-wrapper").slideUp(),e=i.find("input")[2],$(e).val(r),e=i.find("input")[3],$(e).val(n))}))},addVariantBlock:function(t){var e=this;$block=$(this.$blockContainer.children()[0]).clone(),$block.find(".io-select-ar-box").each((function(t,e){0===t?$(e).addClass("io-selected-ar-box"):$(e).removeClass("io-selected-ar-box")})),$block.find(".io-custom-ar-wrapper").hide(),field=$block.find("input")[0],$(field).val(1200),field=$block.find("input")[1],$(field).val(1),field=$block.find("input")[2],$(field).val(16),field=$block.find("input")[3],$(field).val(9),field=$block.find("select")[0],$(field).val(82),field=$block.find("select")[1],$(field).val("jpg"),$block.css(this.getHiddenBlockCss($block)).velocity({opacity:1,"margin-bottom":10},"fast",$.proxy((function(){t?$block.insertBefore(t):$block.appendTo(this.$blockContainer),this.blockSort.addItems($block),this.addAspectRatioHandlers(),$block.find(".settings").each((function(t,i){var a,r,n=$(i);r=e.$container.find(".io-menu-clone > .menu").clone(),$(r).insertAfter(n),(a=new Garnish.MenuBtn(i)).menu.settings.onOptionSelect=$.proxy((function(t){e.onMenuOptionSelect(t,a)}),this)})),this.reIndexVariants()}),this))},deleteVariantBlock:function(t){var e=this;t.velocity(this.getHiddenBlockCss(t),"fast",$.proxy((function(){t.remove(),e.reIndexVariants()}),this))},resetVariantBlockOrder:function(){this.reIndexVariants()}})}},0,[[5679,666,216]]]);
//# sourceMappingURL=field.js.map